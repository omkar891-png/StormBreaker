{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/attendence/StormBreaker/frontend/app/admin/leave/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\n\r\ninterface LeaveRequest {\r\n    id: number;\r\n    student_id: number;\r\n    reason: string;\r\n    start_date: string;\r\n    end_date: string;\r\n    status: string;\r\n    applied_at: string;\r\n    approved_by: number | null;\r\n}\r\n\r\nexport default function AdminLeavePage() {\r\n    const router = useRouter();\r\n    const [leaveRequests, setLeaveRequests] = useState<LeaveRequest[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [filter, setFilter] = useState<string>(\"PENDING\");\r\n\r\n    useEffect(() => {\r\n        fetchData();\r\n    }, [filter]);\r\n\r\n    const fetchData = async () => {\r\n        try {\r\n            const token = localStorage.getItem(\"token\");\r\n\r\n            if (!token) {\r\n                router.push(\"/auth\");\r\n                return;\r\n            }\r\n\r\n            const url = filter === \"ALL\"\r\n                ? \"http://localhost:8000/leave/\"\r\n                : `http://localhost:8000/leave/?status=${filter}`;\r\n\r\n            const res = await fetch(url, {\r\n                headers: { Authorization: `Bearer ${token}` },\r\n            });\r\n\r\n            if (res.ok) {\r\n                const data = await res.json();\r\n                setLeaveRequests(data);\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Error fetching leave requests:\", error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleUpdateStatus = async (leaveId: number, status: string) => {\r\n        try {\r\n            const token = localStorage.getItem(\"token\");\r\n            const res = await fetch(`http://localhost:8000/leave/${leaveId}/status?status=${status}`, {\r\n                method: \"PUT\",\r\n                headers: {\r\n                    Authorization: `Bearer ${token}`,\r\n                },\r\n            });\r\n\r\n            if (res.ok) {\r\n                fetchData();\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Error updating leave status:\", error);\r\n        }\r\n    };\r\n\r\n    const getStatusColor = (status: string) => {\r\n        switch (status) {\r\n            case \"APPROVED\":\r\n                return \"bg-green-100 text-green-800\";\r\n            case \"REJECTED\":\r\n                return \"bg-red-100 text-red-800\";\r\n            default:\r\n                return \"bg-yellow-100 text-yellow-800\";\r\n        }\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"min-h-screen bg-gradient-to-br from-slate-50 to-blue-100 flex items-center justify-center\">\r\n                <div className=\"text-xl text-gray-700\">Loading leave requests...</div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-gradient-to-br from-slate-50 to-blue-100 p-8\">\r\n            <div className=\"max-w-7xl mx-auto\">\r\n                <div className=\"mb-8\">\r\n                    <h1 className=\"text-4xl font-bold text-gray-800 mb-2\">Leave Management</h1>\r\n                    <p className=\"text-gray-600\">Review and approve student leave requests</p>\r\n                </div>\r\n\r\n                <div className=\"mb-6 flex gap-3\">\r\n                    {[\"PENDING\", \"APPROVED\", \"REJECTED\", \"ALL\"].map((status) => (\r\n                        <button\r\n                            key={status}\r\n                            onClick={() => setFilter(status)}\r\n                            className={`px-6 py-2 rounded-lg font-semibold transition-colors ${filter === status\r\n                                    ? \"bg-blue-600 text-white\"\r\n                                    : \"bg-white text-gray-700 hover:bg-gray-100\"\r\n                                }`}\r\n                        >\r\n                            {status}\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n\r\n                {leaveRequests.length === 0 ? (\r\n                    <div className=\"bg-white rounded-xl shadow-lg p-12 text-center\">\r\n                        <div className=\"text-6xl mb-4\">üìã</div>\r\n                        <h2 className=\"text-2xl font-semibold text-gray-700 mb-2\">No Leave Requests</h2>\r\n                        <p className=\"text-gray-500\">No {filter.toLowerCase()} leave requests found.</p>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"grid gap-6\">\r\n                        {leaveRequests.map((leave) => {\r\n                            const startDate = new Date(leave.start_date);\r\n                            const endDate = new Date(leave.end_date);\r\n                            const days = Math.ceil((endDate.getTime() - startDate.getTime()) / (1000 * 60 * 60 * 24)) + 1;\r\n\r\n                            return (\r\n                                <div key={leave.id} className=\"bg-white rounded-xl shadow-lg p-6 hover:shadow-xl transition-shadow\">\r\n                                    <div className=\"flex justify-between items-start mb-4\">\r\n                                        <div className=\"flex-1\">\r\n                                            <div className=\"flex items-center gap-3 mb-2\">\r\n                                                <h3 className=\"text-xl font-semibold text-gray-800\">\r\n                                                    Student ID: {leave.student_id}\r\n                                                </h3>\r\n                                                <span className={`px-3 py-1 rounded-full text-sm font-semibold ${getStatusColor(leave.status)}`}>\r\n                                                    {leave.status}\r\n                                                </span>\r\n                                            </div>\r\n                                            <p className=\"text-gray-700 mb-3 text-lg\">{leave.reason}</p>\r\n                                            <div className=\"flex gap-6 text-sm text-gray-500\">\r\n                                                <span>üìÖ {startDate.toLocaleDateString()} - {endDate.toLocaleDateString()}</span>\r\n                                                <span>‚è±Ô∏è {days} {days === 1 ? 'day' : 'days'}</span>\r\n                                                <span>üïê Applied: {new Date(leave.applied_at).toLocaleDateString()}</span>\r\n                                            </div>\r\n                                        </div>\r\n\r\n                                        {leave.status === \"PENDING\" && (\r\n                                            <div className=\"flex gap-2\">\r\n                                                <button\r\n                                                    onClick={() => handleUpdateStatus(leave.id, \"APPROVED\")}\r\n                                                    className=\"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-semibold\"\r\n                                                >\r\n                                                    ‚úì Approve\r\n                                                </button>\r\n                                                <button\r\n                                                    onClick={() => handleUpdateStatus(leave.id, \"REJECTED\")}\r\n                                                    className=\"px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-semibold\"\r\n                                                >\r\n                                                    ‚úó Reject\r\n                                                </button>\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}